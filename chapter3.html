<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 3: Support and Resistance</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .level-indicator { transition: all 0.3s ease; }
        .level-indicator:hover { transform: scale(1.05); }
        .support-demo, .resistance-demo { cursor: pointer; transition: all 0.2s ease; }
        .support-demo:hover { background-color: #dcfce7; }
        .resistance-demo:hover { background-color: #fee2e2; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <button onclick="goBack()" class="mr-4 p-2 rounded-lg hover:bg-gray-100">
                        <i class="fas fa-arrow-left text-gray-600"></i>
                    </button>
                    <div>
                        <h1 class="text-lg font-semibold text-gray-900">Chapter 3: Support and Resistance</h1>
                        <p class="text-sm text-gray-600">The foundation of price analysis</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-sm text-gray-600">
                        <span id="lesson-progress">0%</span> Complete
                    </div>
                    <button onclick="toggleMenu()" class="p-2 rounded-lg hover:bg-gray-100">
                        <i class="fas fa-bars text-gray-600"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Chapter Content -->
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Hero Section -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 mb-8">
            <div class="p-8">
                <div class="flex items-center mb-6">
                    <div class="w-16 h-16 bg-blue-100 rounded-xl flex items-center justify-center mr-6">
                        <i class="fas fa-layer-group text-blue-600 text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold text-gray-900">Support and Resistance</h1>
                        <p class="text-lg text-gray-600 mt-2">The cornerstone of technical analysis</p>
                    </div>
                </div>
                
                <img src="support_resistance_diagram.png" alt="Support and Resistance Levels" class="w-full rounded-lg shadow-sm mb-6">
                
                <p class="text-lg text-gray-700 leading-relaxed">
                    Support and resistance form the foundation of technical analysis, representing price levels where buying or selling pressure creates barriers to further price movement. Mastering these concepts is essential for identifying high-probability trading opportunities and managing risk effectively.
                </p>
            </div>
        </div>

        <!-- Core Concepts -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Support -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200">
                <div class="p-8">
                    <div class="flex items-center mb-6">
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mr-4">
                            <i class="fas fa-arrow-up text-green-600 text-xl"></i>
                        </div>
                        <div>
                            <h2 class="text-2xl font-bold text-gray-900">Support</h2>
                            <p class="text-gray-600">The price floor</p>
                        </div>
                    </div>

                    <p class="text-gray-700 mb-6 leading-relaxed">
                        Support acts as a floor where buying interest is strong enough to prevent prices from falling further. When price approaches a support level, buyers step in, creating upward pressure that pushes price back up.
                    </p>

                    <div class="space-y-4">
                        <div class="support-demo p-4 border-2 border-dashed border-green-300 rounded-lg">
                            <h4 class="font-semibold text-green-900 mb-2">Characteristics:</h4>
                            <ul class="space-y-2 text-sm text-green-800">
                                <li class="flex items-center">
                                    <i class="fas fa-check text-green-600 mr-2"></i>
                                    <span>Previous lows and buying zones</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check text-green-600 mr-2"></i>
                                    <span>Psychological price levels</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check text-green-600 mr-2"></i>
                                    <span>Volume accumulation areas</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check text-green-600 mr-2"></i>
                                    <span>Moving average support</span>
                                </li>
                            </ul>
                        </div>

                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h5 class="font-semibold text-green-900 mb-2">Trading Strategy</h5>
                            <p class="text-green-800 text-sm">
                                Buy near support levels with stops placed just below. Look for confirmation through candlestick patterns or volume increases.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Resistance -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200">
                <div class="p-8">
                    <div class="flex items-center mb-6">
                        <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center mr-4">
                            <i class="fas fa-arrow-down text-red-600 text-xl"></i>
                        </div>
                        <div>
                            <h2 class="text-2xl font-bold text-gray-900">Resistance</h2>
                            <p class="text-gray-600">The price ceiling</p>
                        </div>
                    </div>

                    <p class="text-gray-700 mb-6 leading-relaxed">
                        Resistance functions as a ceiling where selling pressure prevents prices from rising higher. When price approaches resistance, sellers emerge, creating downward pressure that pushes price back down.
                    </p>

                    <div class="space-y-4">
                        <div class="resistance-demo p-4 border-2 border-dashed border-red-300 rounded-lg">
                            <h4 class="font-semibold text-red-900 mb-2">Characteristics:</h4>
                            <ul class="space-y-2 text-sm text-red-800">
                                <li class="flex items-center">
                                    <i class="fas fa-check text-red-600 mr-2"></i>
                                    <span>Previous highs and selling zones</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check text-red-600 mr-2"></i>
                                    <span>Round number psychological barriers</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check text-red-600 mr-2"></i>
                                    <span>Profit-taking zones</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check text-red-600 mr-2"></i>
                                    <span>Supply concentration areas</span>
                                </li>
                            </ul>
                        </div>

                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                            <h5 class="font-semibold text-red-900 mb-2">Trading Strategy</h5>
                            <p class="text-red-800 text-sm">
                                Sell near resistance levels with stops placed just above. Look for reversal patterns or volume confirmation.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Price Level Demo -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 mb-8">
            <div class="p-8">
                <div class="flex items-center mb-6">
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-chart-line text-blue-600 text-xl"></i>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900">Interactive Price Level Demo</h2>
                        <p class="text-gray-600">Click on the chart to identify support and resistance levels</p>
                    </div>
                </div>

                <div id="interactive-chart" class="w-full h-96 mb-6"></div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <h4 class="font-semibold text-green-900 mb-3">Identified Support Levels</h4>
                        <div id="support-levels" class="space-y-2">
                            <div class="text-sm text-green-700">Click on chart lows to identify support</div>
                        </div>
                    </div>
                    
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                        <h4 class="font-semibold text-red-900 mb-3">Identified Resistance Levels</h4>
                        <div id="resistance-levels" class="space-y-2">
                            <div class="text-sm text-red-700">Click on chart highs to identify resistance</div>
                        </div>
                    </div>
                </div>

                <div class="mt-6 flex space-x-4">
                    <button onclick="clearLevels()" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">
                        Clear Levels
                    </button>
                    <button onclick="showExample()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                        Show Example
                    </button>
                </div>
            </div>
        </div>

        <!-- Key Level Identification -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 mb-8">
            <div class="p-8">
                <div class="flex items-center mb-6">
                    <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-search text-purple-600 text-xl"></i>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900">Key Level Identification</h2>
                        <p class="text-gray-600">How to identify strong support and resistance zones</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="level-indicator bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6 text-center">
                        <div class="w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-history text-white"></i>
                        </div>
                        <h4 class="font-semibold text-gray-900 mb-2">Historical Levels</h4>
                        <p class="text-sm text-gray-600">Previous significant highs and lows where price reversed multiple times</p>
                    </div>

                    <div class="level-indicator bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-6 text-center">
                        <div class="w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-brain text-white"></i>
                        </div>
                        <h4 class="font-semibold text-gray-900 mb-2">Psychological Levels</h4>
                        <p class="text-sm text-gray-600">Round numbers ($100, $50) where human psychology creates natural barriers</p>
                    </div>

                    <div class="level-indicator bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-6 text-center">
                        <div class="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-chart-line text-white"></i>
                        </div>
                        <h4 class="font-semibold text-gray-900 mb-2">Moving Averages</h4>
                        <p class="text-sm text-gray-600">Dynamic support/resistance in trending markets (20, 50, 200-day)</p>
                    </div>

                    <div class="level-indicator bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-6 text-center">
                        <div class="w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-calculator text-white"></i>
                        </div>
                        <h4 class="font-semibold text-gray-900 mb-2">Fibonacci Levels</h4>
                        <p class="text-sm text-gray-600">Mathematical retracement levels (38.2%, 50%, 61.8%) for potential reversals</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Trading Strategies -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 mb-8">
            <div class="p-8">
                <div class="flex items-center mb-6">
                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-chess text-green-600 text-xl"></i>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900">Trading Strategies</h2>
                        <p class="text-gray-600">How to trade support and resistance levels effectively</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-bounce text-white text-sm"></i>
                            </div>
                            <h4 class="font-semibold text-blue-900">Bounce Strategy</h4>
                        </div>
                        <p class="text-blue-800 text-sm mb-4">
                            Trade the reversal when price approaches support or resistance levels. Look for confirmation patterns.
                        </p>
                        <div class="space-y-2 text-xs">
                            <div class="flex items-center text-blue-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                <span>Buy at support, sell at resistance</span>
                            </div>
                            <div class="flex items-center text-blue-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                <span>Wait for confirmation signals</span>
                            </div>
                            <div class="flex items-center text-blue-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                <span>Use tight stop losses</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-door-open text-white text-sm"></i>
                            </div>
                            <h4 class="font-semibold text-purple-900">Breakout Strategy</h4>
                        </div>
                        <p class="text-purple-800 text-sm mb-4">
                            Trade when price decisively breaks through support or resistance, often leading to strong directional moves.
                        </p>
                        <div class="space-y-2 text-xs">
                            <div class="flex items-center text-purple-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                <span>Wait for confirmed breaks</span>
                            </div>
                            <div class="flex items-center text-purple-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                <span>Use volume confirmation</span>
                            </div>
                            <div class="flex items-center text-purple-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                <span>Target next key level</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-undo text-white text-sm"></i>
                            </div>
                            <h4 class="font-semibold text-orange-900">Pullback Strategy</h4>
                        </div>
                        <p class="text-orange-800 text-sm mb-4">
                            Enter trades when price returns to broken support (now resistance) or broken resistance (now support).
                        </p>
                        <div class="space-y-2 text-xs">
                            <div class="flex items-center text-orange-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                <span>Lower risk entries</span>
                            </div>
                            <div class="flex items-center text-orange-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                <span>Trend continuation setup</span>
                            </div>
                            <div class="flex items-center text-orange-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                <span>Better risk-reward ratios</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="flex justify-between items-center">
            <button onclick="goBack()" class="flex items-center text-gray-600 hover:text-gray-900">
                <i class="fas fa-arrow-left mr-2"></i>
                Back to Course
            </button>
            <button onclick="nextChapter()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700">
                Next Chapter
            </button>
        </div>
    </div>

    <script>
        let supportLevels = [];
        let resistanceLevels = [];
        let clickCount = 0;

        function initializeInteractiveChart() {
            // Generate sample price data
            const dates = [];
            const prices = [];
            let basePrice = 100;
            
            for (let i = 0; i < 50; i++) {
                dates.push(`Day ${i + 1}`);
                basePrice += (Math.random() - 0.5) * 3;
                prices.push(basePrice);
            }

            const trace = {
                x: dates,
                y: prices,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Price',
                line: { color: '#3b82f6', width: 2 },
                marker: { size: 4 }
            };

            const layout = {
                title: 'Click on chart highs and lows to identify levels',
                xaxis: { title: 'Time Period' },
                yaxis: { title: 'Price ($)' },
                showlegend: false,
                margin: { t: 40, r: 40, b: 40, l: 60 },
                clickmode: 'event+select'
            };

            Plotly.newPlot('interactive-chart', [trace], layout, {responsive: true});

            // Add click event listener
            document.getElementById('interactive-chart').on('plotly_click', function(data) {
                const point = data.points[0];
                const price = point.y;
                const isHigh = Math.random() > 0.5; // Simulate high/low detection
                
                addLevel(price, isHigh);
            });
        }

        function addLevel(price, isHigh) {
            clickCount++;
            
            if (isHigh) {
                resistanceLevels.push(price);
                updateLevelsList('resistance-levels', resistanceLevels, 'red');
            } else {
                supportLevels.push(price);
                updateLevelsList('support-levels', supportLevels, 'green');
            }
            
            // Add level to chart
            addLevelToChart(price, isHigh);
        }

        function updateLevelsList(containerId, levels, color) {
            const container = document.getElementById(containerId);
            const levelsText = color === 'green' ? 'Support Levels' : 'Resistance Levels';
            
            if (levels.length === 0) {
                container.innerHTML = `<div class="text-sm text-${color}-700">Click on chart ${color === 'green' ? 'lows' : 'highs'} to identify ${levelsText.toLowerCase()}</div>`;
                return;
            }
            
            container.innerHTML = `
                <div class="text-sm font-semibold text-${color}-900 mb-2">${levelsText}:</div>
                ${levels.map((level, index) => `
                    <div class="flex justify-between items-center text-xs text-${color}-700 bg-white rounded px-2 py-1">
                        <span>Level ${index + 1}: $${level.toFixed(2)}</span>
                        <button onclick="removeLevel(${index}, '${color}')" class="text-${color}-500 hover:text-${color}-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `).join('')}
            `;
        }

        function addLevelToChart(price, isHigh) {
            const color = isHigh ? 'red' : 'green';
            const shape = {
                type: 'line',
                x0: 0,
                x1: 1,
                xref: 'paper',
                y0: price,
                y1: price,
                line: {
                    color: color,
                    width: 2,
                    dash: 'dash'
                }
            };
            
            Plotly.relayout('interactive-chart', {
                shapes: [...(document.getElementById('interactive-chart').layout.shapes || []), shape]
            });
        }

        function clearLevels() {
            supportLevels = [];
            resistanceLevels = [];
            clickCount = 0;
            
            updateLevelsList('support-levels', supportLevels, 'green');
            updateLevelsList('resistance-levels', resistanceLevels, 'red');
            
            Plotly.relayout('interactive-chart', { shapes: [] });
        }

        function showExample() {
            clearLevels();
            
            // Add example support and resistance levels
            const exampleSupports = [98.5, 102.3, 105.8];
            const exampleResistances = [108.2, 112.1, 115.6];
            
            exampleSupports.forEach(price => addLevel(price, false));
            exampleResistances.forEach(price => addLevel(price, true));
        }

        function removeLevel(index, type) {
            if (type === 'green') {
                supportLevels.splice(index, 1);
                updateLevelsList('support-levels', supportLevels, 'green');
            } else {
                resistanceLevels.splice(index, 1);
                updateLevelsList('resistance-levels', resistanceLevels, 'red');
            }
            
            // Redraw all shapes
            Plotly.relayout('interactive-chart', { shapes: [] });
            [...supportLevels, ...resistanceLevels].forEach((price, i) => {
                const isHigh = i >= supportLevels.length;
                addLevelToChart(price, isHigh);
            });
        }

        function updateProgress(percentage) {
            document.getElementById('lesson-progress').textContent = percentage;
            
            // SCORM: Update progress
            if (typeof SCORM !== 'undefined') {
                SCORM.set('cmi.core.lesson_location', 'chapter3');
                SCORM.set('cmi.core.lesson_status', percentage === 100 ? 'completed' : 'incomplete');
            }
        }

        function nextChapter() {
            updateProgress(100);
            window.location.href = 'chapter4.html';
        }

        function goBack() {
            window.location.href = 'index.html';
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeInteractiveChart();
            updateProgress(50); // Mark as in progress
        });
    </script>
</body>
</html>